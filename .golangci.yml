version: "2"
run:
  concurrency: 6
linters:
  default: none
  enable:
    - depguard
    - dupl
    - goconst
    - gocritic
    - revive
    - gosec
    - govet
    - ineffassign
    - misspell
    - staticcheck # Consolidates staticcheck, gosimple, and stylecheck.
    - unconvert
    - unparam
    - gocyclo
  exclusions:
    paths:
      - ".*_test\\.go"
      - "lib/.*"
      - "internal/experimental/"
  settings:
    gocritic:
      enabled-checks:
        # Diagnostic
        - argOrder
        - badCond
        - caseOrder
        - codegenComment
        - commentedOutCode
        - deprecatedComment
        - dupArg
        - dupBranchBody
        - dupCase
        - dupSubExpr
        - exitAfterDefer
        - flagDeref
        - flagName
        - nilValReturn
        - offBy1
        - weakCond
        - octalLiteral
        - sloppyReassign

        # Performance
        - equalFold
        - indexAlloc
        - rangeExprCopy
        - appendCombine

        # Style
        - assignOp
        - boolExprSimplify
        - captLocal
        - commentFormatting
        - commentedOutImport
        - defaultCaseOrder
        - docStub
        - elseif
        - emptyFallthrough
        - emptyStringTest
        - hexLiteral
        - methodExprCall
        - regexpMust
        - singleCaseSwitch
        - sloppyLen
        - stringXbytes
        - switchTrue
        - typeAssertChain
        - typeSwitchVar
        - underef
        - unlabelStmt
        - unlambda
        - unslice
        - valSwap
        - yodaStyleExpr
        - wrapperFunc

        # Opinionated
        - initClause
        - nestingReduce
        - ptrToRefParam
        - typeUnparen
        - unnecessaryBlock
        - paramTypeCombine
    gosec:
      severity: high
      confidence: medium
      excludes:
        - G204
    depguard:
      rules:
        Main:
          deny:
            - desc: "Use k8s.io/klog/v2 instead of github.com/golang/glog"
              pkg: github.com/golang/glog
    revive:
      rules:
        - name: exported
          severity: warning
          disabled: true
formatters:
  enable:
    - gofmt
    - goimports
output:
  formats:
    checkstyle:
      path: checkstyle-golangci-lint.xml
    text:
      path: stdout
